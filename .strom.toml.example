# Strom Configuration File
#
# This file demonstrates all available configuration options.
# Copy this file to .strom.toml and customize as needed.
#
# Configuration priority (highest to lowest):
# 1. Command-line arguments
# 2. Environment variables (STROM_* prefix)
# 3. Local config file (.strom.toml in current directory)
# 4. User config file (~/.config/strom/config.toml on Linux)
# 5. Default values

# ============================================================================
# Server Configuration
# ============================================================================
[server]
# Port to listen on for HTTP/WebSocket connections
# Default: 8080
# CLI: --port 8080
# Env: STROM_SERVER_PORT=8080
port = 8080

# ICE servers for WebRTC NAT traversal (STUN/TURN)
# Used by WHEP/WHIP blocks and the WHEP player
# Format: Array of URLs like "stun:host:port" or "turn:user:pass@host:port"
# Default: ["stun:stun.l.google.com:19302"]
# Env: STROM_SERVER_ICE_SERVERS (comma-separated)
# ice_servers = [
#     "stun:stun.l.google.com:19302",
#     "turn:username:password@turn.example.com:3478"
# ]

# ICE transport policy for WebRTC connections
# "all" (default) = use all candidate types (host, srflx, relay)
# "relay" = only use TURN relay candidates (forces traffic through TURN server)
# Env: STROM_SERVER_ICE_TRANSPORT_POLICY=relay
# ice_transport_policy = "all"

# TLS/HTTPS (optional)
# When both tls_cert and tls_key are set, the server serves HTTPS instead of HTTP.
# Certificate and key must be in PEM format. The cert file can include intermediates.
# Generate certs for local development with: mkcert <your-ip> localhost
# CLI: --tls-cert cert.pem --tls-key key.pem
# Env: STROM_TLS_CERT=cert.pem STROM_TLS_KEY=key.pem
# tls_cert = "cert.pem"
# tls_key = "key.pem"

# ============================================================================
# Storage Configuration
# ============================================================================
[storage]
# PostgreSQL database URL (recommended for production)
# If set, PostgreSQL is used instead of JSON files for flow storage
# Format: postgresql://user:password@host/database_name
# CLI: --database-url postgresql://...
# Env: STROM_STORAGE_DATABASE_URL=postgresql://...
# database_url = "postgresql://strom:password@localhost/strom"

# Data directory (contains flows.json and blocks.json when using JSON storage)
# Default:
#   - Docker: ./data/ (current directory)
#   - Linux: ~/.local/share/strom/
# CLI: --data-dir /path/to/data
# Env: STROM_STORAGE_DATA_DIR=/path/to/data
# data_dir = "/var/lib/strom"

# Custom path to flows storage file (overrides data_dir)
# CLI: --flows-path /custom/flows.json
# Env: STROM_STORAGE_FLOWS_PATH=/custom/flows.json
# flows_path = "/custom/path/flows.json"

# Custom path to blocks storage file (overrides data_dir)
# CLI: --blocks-path /custom/blocks.json
# Env: STROM_STORAGE_BLOCKS_PATH=/custom/blocks.json
# blocks_path = "/custom/path/blocks.json"

# ============================================================================
# Logging Configuration
# ============================================================================
[logging]
# Path to log file (if set, logs will be written to file in addition to stdout)
# File logs include timestamps and module targets (no ANSI colors)
# Console logs remain compact for readability
# Env: STROM_LOGGING_LOG_FILE=strom.log
# log_file = "strom.log"
# log_file = "/var/log/strom/strom.log"

# Log level (if set, overrides RUST_LOG environment variable)
# Values: trace, debug, info, warn, error
# Default: info
# Env: STROM_LOGGING_LOG_LEVEL=debug
# log_level = "info"
# log_level = "debug"

# Advanced: Module-specific logging (requires RUST_LOG environment variable)
# RUST_LOG=strom=debug,strom::gst=trace
# RUST_LOG=info,strom::gst::pipeline=debug
#
# Priority for log level:
# 1. RUST_LOG environment variable (highest)
# 2. log_level in this config file
# 3. Default: "info"
